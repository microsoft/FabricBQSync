# Fabric Sync AutoDiscovery

The autodiscovery process is responsible for applying a set of built-in huerstics to the available BigQuery metadata to discover the most optimal approach for syncing data between BigQuery and the Fabric Lakehouse.

### Load Stratgies
Load strategies determine how data is going to be load from BigQuery. The following strategies can be either auto discovered or specified in user-configuration:
- *CDC Append* - Default load strategy when <code>use_cdc</code> is <code>True</code>. Uses the BigQuery <code>APPENDS</code> function to return appended rows for a given time range. After an initial full-table sync, incremental changes are appended to the mirrored data. The APPENDS function enforces a max window of 7-days. If the sync frequency is greater than 7 days, multiple sync iterations are required to ensure that mirrored data is up to date.
- *CDC* - Requires the Fabric Sync setting <code>use_cdc</code> and BigQuery table option <code>enable_change_history</code> set to <code>True</code>. INSERTS, UPDATES and DELETES are recorded for the BigQuery table and are merged into the mirrored data. BigQuery limits the CDC CHANGES windows to 24-hours and does not include changes within 10-minutes of the current time. If the sync frequency is greater than 24 hours, multiple sync iterations are required to ensure that mirrored data is up to date.
- *Full Load* – Default load strategy when <code>use_cdc</code> is <code>False</code>. The entire table and all of its data are synchronized from BigQuery. Any previously mirrored data is overwritten. This strategy, while being least optimal, is used only when an alternate more optimal strategy can’t be resolved.
- *Watermark* – When a table is defined with a single primary-key that is either date/time or integer-derived data-typed, data can be loaded incrementally. The key column is used as a watermark to determine the delta between BQ and Fabric. This strategy can be combined with the partitioning strategy below to super-charge how data is incrementally synced in well optimized BigQuery environments.
- *Partition* – Partition tables can be loaded by partition. Inactive (archived) partitions or partitions where no changes have occurred are skipped and are not evaluated. The accelerator is capable of handle all types of partitioning that BigQuery supports including tables that use time ingestion or range partition startegies.
    - The autodiscovery process will also discover when BQ tables are configured to require partition filters. While the sync process adapts for this constraint it may have reduce performance during the initial load process. To optimize the initial load of historical data, consider removing the <code>Require Partition Filter</code> constraint from the table during the initial loading, if possible.

### Load Types
The accelerator also resolves load type based largely based on load strategy. The Load type defines how newly arriving data is loaded tp the Fabric Lakehouse. These types are:
- Overwrite – Data for each table or partition, overwrites any existing data in the destination. This type is used for Full and Partition-based load strategies.
- Append – Data is appended to existing data in the Fabric Lakehouse. This is the default for the Watermark load strategy but can be applied to the Partition load strategy through user-configuration override.
- Merge – The “upsert” pattern is never autodiscovered but can be defined within user configuration. Merge is used to either insert new data or update existing data in the destination based on a set of matching criteria. 